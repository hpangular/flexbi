"use strict";(self.webpackChunkxero_frontend=self.webpackChunkxero_frontend||[]).push([[354],{2354:(M,v,r)=>{r.r(v),r.d(v,{SubscriptionsModule:()=>O});var m=r(6895),d=r(87),h=r(2023),t=r(4650),C=r(1135),u=r(2340),p=r(3651),y=r(529),P=r(9653);let g=(()=>{class n{constructor(e,i){this.http=e,this.store=i,this.socialLogin=new C.X(!1)}registerUserByThirdParty(e){return this.http.post(`${u.N.serviceUrl}${p.u.CLIENT_PROFILE}`,e,{params:{skipAuthorization:"true"}})}getSubscriptions(){return this.http.get(`${u.N.serviceUrl}${p.u.SUBSCRIPTION_LIST}`)}getActivePlan(e){return this.http.get(`${u.N.serviceUrl}${p.u.SUBSCRIPTION_ACTIVE_GET}${e}`)}activateFreeTrail(e){return this.http.get(`${u.N.serviceUrl}${p.u.SUBSCRIPTION_ACTIVE_FREE}${e}`)}addCompanyName(e){return this.http.post(`${u.N.serviceUrl}${p.u.CLIENT_PROFILE_COMPANY_NAME}`,e)}getSharedPaymentURL(e){return this.http.post(`${u.N.serviceUrl}${p.u.SUBSCRIPTION_PAYMENT_URL}`,e)}getTheTransactionStatus(e){return this.http.post(`${u.N.serviceUrl}${p.u.SUBSCRIPTION_STATUS}`,e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(y.eN),t.LFG(P.yh))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var f=r(2013),T=r(1481);function S(n,o){if(1&n&&t._UZ(0,"iframe",2),2&n){const e=t.oxw();t.Q6J("src",e.paymentObj.RedirectURL,t.uOi)}}let A=(()=>{class n{constructor(e,i,s,a){this.subscription=e,this.notifcation=i,this.sanitizer=s,this.model=a,this.paymentObj={paymentURL:"",isRedirectToPayment:!1}}ngOnInit(){this.getSharedPaymentURL()}getSharedPaymentURL(){this.subscription.getSharedPaymentURL({userId:this.planRequest.userId,PlanId:this.planRequest.PlanId}).subscribe(e=>{500===e.status?this.notifcation.error(e.message+" ("+e.errorMessage+")"):(this.paymentObj.RedirectURL=this.sanitizer.bypassSecurityTrustResourceUrl(e.redirectURL),this.paymentObj.isRedirectToPayment=!0)},e=>{this.model.close(),this.notifcation.error("Payment Failure...")})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g),t.Y36(f.g),t.Y36(T.H7),t.Y36(d.Kz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-accept-payment-prompt"]],inputs:{planRequest:"planRequest"},decls:4,vars:1,consts:[[1,"box"],["style","width: 5px; height: 5px; visibility: hidden","target","_self",3,"src",4,"ngIf"],["target","_self",2,"width","5px","height","5px","visibility","hidden",3,"src"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h6"),t._uU(2,"Redirecting to payment gateway, please wait..."),t.qZA(),t.YNc(3,S,1,1,"iframe",1),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngIf",i.paymentObj.isRedirectToPayment))},dependencies:[m.O5],styles:[".box[_ngcontent-%COMP%]{padding:15px}"]}),n})();var c=r(433),b=r(7556);let U=(()=>{class n{constructor(e,i,s,a,l){this.modal=e,this.fb=i,this.subscription=s,this.authService=a,this.notification=l}ngOnInit(){this.form=this.fb.group({CompanyName:["",c.kI.required],userId:[this.user_id]})}submit(){this.form.invalid||this.subscription.addCompanyName(this.form.value).subscribe(e=>{if(200===e.status){const i=this.authService.getLoggedInUserDetails();i.CompanyName=this.form.value.CompanyName,this.authService.setLoggedInUserDetails(i)}},e=>{this.notification.error(e.message),this.modelClose()})}modelClose(){this.modal.close()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.Kz),t.Y36(c.qu),t.Y36(g),t.Y36(b.e),t.Y36(f.g))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-company-name"]],inputs:{user_id:"user_id",confirmText:"confirmText",yesAction:"yesAction",noAction:"noAction"},decls:18,vars:2,consts:[[1,"modal-header"],["aria-label","Close",1,"close-icon","absolute-btn",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"row"],[1,"col-sm-12"],[1,"form-label"],["type","email","formControlName","CompanyName",1,"form-control"],[1,"invalid"],[1,"modal-footer"],[1,"dialog-footer-btn-wrapper","two-buttons"],[1,"btn","btn-danger","discard-btn",3,"click"],[1,"btn","btn-primary",3,"click"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0),t._uU(1," Company Name "),t.TgZ(2,"span",1),t.NdJ("click",function(){return i.modelClose()}),t.qZA()(),t.TgZ(3,"div",2)(4,"form",3)(5,"div",4)(6,"div",5)(7,"label",6),t._uU(8,"Company Name"),t.qZA(),t._UZ(9,"input",7),t.TgZ(10,"div",8),t._uU(11),t.qZA()()()()(),t.TgZ(12,"div",9)(13,"div",10)(14,"button",11),t.NdJ("click",function(){return i.modelClose()}),t._uU(15," Close "),t.qZA(),t.TgZ(16,"button",12),t.NdJ("click",function(){return i.submit()}),t._uU(17,"Submit"),t.qZA()()()),2&e){let s;t.xp6(4),t.Q6J("formGroup",i.form),t.xp6(7),t.hij(" ",null!=(s=i.form.get("CompanyName"))&&s.touched?null!=(s=i.form.get("CompanyName"))&&null!=s.errors&&s.errors.required?"Company Name required.":null!=(s=i.form.get("CompanyName"))&&null!=s.errors&&s.errors.pattern?"Company Name Required":"":""," ")}},dependencies:[c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u],styles:[".two-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px}.modal-header[_ngcontent-%COMP%]{font-size:16px;font-weight:700}.invalid[_ngcontent-%COMP%]{color:red;font-size:12px}"]}),n})();function x(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",6)(1,"div",7)(2,"div",8)(3,"h5",9),t._uU(4),t.qZA(),t.TgZ(5,"h6",10),t._uU(6),t._UZ(7,"span",11),t.qZA()(),t.TgZ(8,"div",12)(9,"ul",13)(10,"li",14),t._UZ(11,"i",15),t._uU(12),t.qZA(),t.TgZ(13,"li",14),t._uU(14,"\xa0"),t.qZA(),t.TgZ(15,"li",14),t._uU(16,"\xa0"),t.qZA()(),t.TgZ(17,"div",16)(18,"button",17),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.activateFreeTrail())}),t._uU(19),t.qZA()()()()()}if(2&n){const e=o.$implicit,i=t.oxw();t.xp6(4),t.hij(" ",e.PlanName," "),t.xp6(2),t.hij(" $ ",e.Amount," "),t.xp6(6),t.hij("Free Trial for ",e.Days," Days "),t.xp6(6),t.Q6J("disabled",(null==i.activePlanDetail?null:i.activePlanDetail.planId)===e.id||i.isTrialActivated),t.xp6(1),t.hij(" ",i.isTrialActivated?"Current Plan":"Activate"," ")}}function I(n,o){1&n&&(t.TgZ(0,"span",20),t._uU(1,"Most Popular"),t.qZA())}function _(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",18)(1,"div",7),t.YNc(2,I,2,0,"span",19),t.TgZ(3,"div",8)(4,"h5",9),t._uU(5),t.qZA(),t.TgZ(6,"h6",10),t._uU(7),t._UZ(8,"span",11),t.qZA()(),t.TgZ(9,"div",12)(10,"ul",13)(11,"li",14),t._UZ(12,"i",15),t._uU(13),t.qZA(),t.TgZ(14,"li",14),t._UZ(15,"i",15),t._uU(16,"Xero Data Integration "),t.qZA(),t.TgZ(17,"li",14),t._UZ(18,"i",15),t._uU(19,"Power BI Reports "),t.qZA()(),t.TgZ(20,"div",16)(21,"button",17),t.NdJ("click",function(){const a=t.CHM(e).$implicit,l=t.oxw();return t.KtG(l.activatePlan(a))}),t._uU(22," Activate "),t.qZA()()()()()}if(2&n){const e=o.$implicit,i=o.index,s=t.oxw();t.xp6(2),t.Q6J("ngIf",0===i),t.xp6(3),t.hij(" ",e.PlanName," "),t.xp6(2),t.hij(" $ ",e.Amount," "),t.xp6(6),t.hij("Free Trial for ",e.Days," Days "),t.xp6(8),t.Q6J("disabled",(null==s.activePlanDetail?null:s.activePlanDetail.planId)===e.id)}}const N=[{path:"",component:(()=>{class n{constructor(e,i,s,a,l){if(this.subscriptionService=e,this.authService=i,this.modalService=s,this.activeRoute=a,this.notification=l,this.isTranComplete=null,this.AccessCode=null,this.tranObj={},this.subDetails=null,this.isPlanActivated=!1,this.isTrialActivated=!1,null!==this.activeRoute.snapshot.queryParamMap.get("isTranComplete")&&null!==this.activeRoute.snapshot.queryParamMap.get("AccessCode")){this.AccessCode=this.activeRoute.snapshot.queryParamMap.get("AccessCode"),this.isTranComplete=this.activeRoute.snapshot.queryParamMap.get("isTranComplete");const F=this.activeRoute.snapshot.queryParamMap.get("planId");this.getTheTransactionStatus(this.isTranComplete,this.AccessCode,this.authService.getLoggedInUserDetails().UserId,F)}else this.getSubscriptionsPlans();this.getActivePlan()}ngOnInit(){}getSubscriptionsPlans(){this.subscriptionService.getSubscriptions().subscribe(e=>{this.subscriptionPlans=e.filter(i=>i.IsActive),this.dumysubPlanList=e,this.freePlan=e.filter(i=>1===i.id),this.premiumPlans=e.filter(i=>1!==i.id&&!0===i.IsActive)})}getActivePlan(){let e=this.authService.getLoggedInUserDetails().UserId;this.subscriptionService.getActivePlan(e).subscribe(i=>{this.activePlanDetail=i.data[0],1===this.activePlanDetail.id_FkSubscriptionPlan&&(this.isTrialActivated=!0)})}activateFreeTrail(){const e=this.authService.getLoggedInUserDetails().UserId,i=this.authService.getLoggedInUserDetails().CompanyName;i&&i.length>0?this.activateFreeTrialPlanMethod(e):this.modalService.open(U,{centered:!0}).componentInstance.user_id=e}activateFreeTrialPlanMethod(e){this.subscriptionService.activateFreeTrail(e).subscribe(i=>{i&&200===i.status&&this.getActivePlan()})}activatePlan(e){const i=this.authService.getLoggedInUserDetails().UserId,s=this.authService.getLoggedInUserDetails().CompanyName;this.modalService.open(A,{centered:!0}).componentInstance.planRequest={userId:i,CompanyName:s,PlanName:e.PlanName,PlanAmount:e.Amount,PlanId:e.id}}getPlan(e){const i=[];return this.dumysubPlanList.map("TRIAL"===e?s=>{1===s.id&&i.push(s)}:s=>{1!==s.id&&s.IsActive&&i.push(s)}),i}getTheTransactionStatus(e,i,s,a){this.subscriptionService.getTheTransactionStatus({isTranComplete:e,AccessCode:i,userId:s,planId:a}).subscribe(l=>{200===l.status?(this.tranObj={isTranVerified:l.isTranVerified,tranId:l.tranId,planData:l.planData},this.getActivePlan(),this.getSubscriptionsPlans()):(this.tranObj={isTranVerified:!1,tranId:null,planData:null},this.getActivePlan(),this.getSubscriptionsPlans())},l=>{this.notification.success("Failed to get transaction details. Try again...")})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g),t.Y36(b.e),t.Y36(d.FF),t.Y36(h.gz),t.Y36(f.g))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-subscriptions"]],decls:7,vars:2,consts:[[1,"page-breadcrumb","d-none","d-sm-flex","align-items-center","mb-3"],[1,"breadcrumb-title","pe-3"],[1,"pricing-table"],[1,"row","row-cols-1","row-cols-lg-3"],["class","col",4,"ngFor","ngForOf"],["class","col relative",4,"ngFor","ngForOf"],[1,"col"],[1,"card","mb-5","mb-lg-0"],[1,"card-header","bg-flexbi","py-3"],[1,"card-title","text-white","text-uppercase","text-center"],[1,"card-price","text-white","text-center"],[1,"term"],[1,"card-body"],[1,"list-group","list-group-flush"],[1,"list-group-item"],[1,"bx","bx-check","me-2","font-18"],[1,"d-grid"],[1,"btn","btn-flexbi","my-2","radius-30","text-weight-bold",3,"disabled","click"],[1,"col","relative"],["class","most-popular-label",4,"ngIf"],[1,"most-popular-label"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2,"Subscription Plans"),t.qZA()(),t.TgZ(3,"div",2)(4,"div",3),t.YNc(5,x,20,5,"div",4),t.YNc(6,_,23,5,"div",5),t.qZA()()),2&e&&(t.xp6(5),t.Q6J("ngForOf",i.freePlan),t.xp6(1),t.Q6J("ngForOf",i.premiumPlans))},dependencies:[m.sg,m.O5],styles:[".bg-flexbi[_ngcontent-%COMP%]{background-color:#21cead!important}.btn-flexbi[_ngcontent-%COMP%]{color:#fff;background-color:#21cead;border-color:#21cead}.card[_ngcontent-%COMP%]{height:100%}.most-popular-label[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:-24px;left:50%;transform:translate(-50%);width:149px;height:49px;border-radius:40.5px;box-shadow:0 8px 30px #0000001a;border:3px solid #fff;background-color:#fff;font-size:14px;font-weight:900;text-align:center;line-height:43px;color:#21cead;z-index:9}.relative[_ngcontent-%COMP%]{position:relative}.card-title[_ngcontent-%COMP%]{margin-top:35px}.text-weight-bold[_ngcontent-%COMP%]{font-weight:700}"]}),n})()}];let Z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild(N),h.Bz]}),n})();var R=r(7753);let O=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.ez,Z,d.IJ,R.zk,c.UX]}),n})()}}]);